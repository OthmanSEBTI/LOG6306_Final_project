,sha,message,repo,issue_id,issue_state,creation_date,closing_date
0,a6a1e9265b2963e08bf7034feb2d59f1942e8d2f,"Update Facebook, Slack, Webex adapters (#4214)//* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages",microsoft/botbuilder-dotnet,#4214,closed,2020-07-01T12:55:41Z,2020-07-01T14:48:46Z
1,593918dc8ee17297d034c1b9119c412ea4b5af41,Filter adapter dlls from vstest default pattern (#5730),microsoft/azure-pipelines-tasks,#5730,closed,2017-10-30T04:22:07Z,2017-11-06T09:22:21Z
2,44843fdace107f23bb9351c05e0d5789aea3164e,Users/nigurr/fix adapter pattern (#3677)//* Ignore case sensitivity while searching Adapters - xunit as an example////* Bumped up task version,microsoft/azure-pipelines-tasks,#3677,closed,2017-02-22T13:51:37Z,2017-02-23T04:12:20Z
3,31eb77e5923f48906844427a1b2a299bb1cadaf5,Fixes #1558 - Bump C# samples should use  new constructor for BotFrameworkHttpAdapter (#1605)//* Update samples to use 4.4.5 BotFrameworkHttpAdapter////use new Adapter pattern using IConfiguration//remove ICredentialProvider//update csproj files to use 4.4.5 of the bot fx////* More gov cloud updates////* address code review feedback////remove unnecessary package references from csproj files,microsoft/BotBuilder-Samples,#1558,closed,2019-06-07T16:37:11Z,2019-06-27T23:13:05Z
4,31eb77e5923f48906844427a1b2a299bb1cadaf5,Fixes #1558 - Bump C# samples should use  new constructor for BotFrameworkHttpAdapter (#1605)//* Update samples to use 4.4.5 BotFrameworkHttpAdapter////use new Adapter pattern using IConfiguration//remove ICredentialProvider//update csproj files to use 4.4.5 of the bot fx////* More gov cloud updates////* address code review feedback////remove unnecessary package references from csproj files,microsoft/BotBuilder-Samples,#1605,closed,2019-06-27T20:15:32Z,2019-06-27T23:13:05Z
5,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4211,closed,2020-07-01T07:42:57Z,2020-07-15T14:12:51Z
6,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3923,closed,2020-05-14T02:08:32Z,2020-05-14T02:39:28Z
7,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3924,closed,2020-05-14T02:51:37Z,2020-05-14T19:20:55Z
8,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3921,closed,2020-05-13T22:01:08Z,2020-05-14T19:34:50Z
9,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3929,closed,2020-05-15T01:10:11Z,2020-05-18T18:29:40Z
10,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3948,closed,2020-05-18T18:28:27Z,2020-05-18T22:47:19Z
11,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3950,closed,2020-05-18T22:26:43Z,2020-05-19T18:48:49Z
12,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3944,closed,2020-05-18T03:13:08Z,2020-05-20T02:51:04Z
13,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3912,closed,2020-05-13T02:39:42Z,2020-05-20T06:55:21Z
14,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3946,closed,2020-05-18T12:29:54Z,2020-05-20T07:31:23Z
15,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3951,closed,2020-05-19T00:00:48Z,2020-05-21T21:04:41Z
16,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3966,closed,2020-05-21T05:16:30Z,2020-05-21T21:16:01Z
17,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3967,closed,2020-05-21T21:28:23Z,2020-05-21T21:58:13Z
18,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3949,closed,2020-05-18T18:40:32Z,2020-05-21T23:59:49Z
19,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3983,closed,2020-05-26T17:11:36Z,2020-05-27T17:23:03Z
20,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3999,closed,2020-05-28T17:50:40Z,2020-05-28T18:19:32Z
21,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3934,closed,2020-05-15T07:06:38Z,2020-05-29T01:50:09Z
22,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3994,closed,2020-05-28T07:05:29Z,2020-05-29T05:33:36Z
23,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3992,closed,2020-05-28T06:50:53Z,2020-05-29T06:24:07Z
24,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3932,closed,2020-05-15T05:31:23Z,2020-05-30T08:01:31Z
25,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4002,closed,2020-05-29T14:12:38Z,2020-05-30T08:28:45Z
26,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3991,closed,2020-05-28T02:15:26Z,2020-06-01T20:09:10Z
27,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3987,closed,2020-05-27T02:30:08Z,2020-06-02T01:47:44Z
28,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3988,closed,2020-05-27T07:44:27Z,2020-06-02T01:48:03Z
29,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4000,closed,2020-05-28T21:01:30Z,2020-06-01T22:46:09Z
30,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4015,closed,2020-06-02T01:48:56Z,2020-06-02T19:54:23Z
31,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4021,closed,2020-06-03T07:27:16Z,2020-06-03T12:44:57Z
32,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4012,closed,2020-06-01T06:52:20Z,2020-06-04T22:38:51Z
33,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4024,closed,2020-06-04T08:35:34Z,2020-06-06T04:28:13Z
34,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4026,closed,2020-06-05T04:54:19Z,2020-06-07T23:49:35Z
35,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3898,closed,2020-05-11T02:57:37Z,2020-06-11T07:09:56Z
36,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4017,closed,2020-06-02T06:51:13Z,2020-06-12T03:36:55Z
37,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4031,closed,2020-06-08T21:04:03Z,2020-06-12T13:56:17Z
38,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4061,closed,2020-06-12T17:55:53Z,2020-06-12T20:42:13Z
39,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4067,closed,2020-06-15T12:57:11Z,2020-06-15T21:09:16Z
40,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4046,closed,2020-06-10T14:01:36Z,2020-06-16T15:38:58Z
41,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3760,closed,2020-04-17T23:54:35Z,2020-06-15T15:54:00Z
42,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4074,closed,2020-06-16T02:52:40Z,2020-06-16T21:00:37Z
43,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4078,closed,2020-06-16T18:17:20Z,2020-06-16T23:49:41Z
44,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4110,closed,2020-06-17T18:04:32Z,2020-06-17T19:56:28Z
45,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4082,closed,2020-06-16T23:19:14Z,2020-06-17T20:52:39Z
46,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4115,closed,2020-06-17T22:22:40Z,2020-06-17T23:09:17Z
47,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4107,closed,2020-06-17T18:00:26Z,2020-06-17T23:09:17Z
48,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4056,closed,2020-06-12T01:26:37Z,2020-06-17T23:49:06Z
49,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4032,closed,2020-06-09T00:44:39Z,2020-06-18T00:07:57Z
50,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3923,closed,2020-05-14T02:08:32Z,2020-05-14T02:39:28Z
51,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3964,closed,2020-05-20T23:34:07Z,2020-05-21T19:42:31Z
52,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3966,closed,2020-05-21T05:16:30Z,2020-05-21T21:16:01Z
53,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3978,closed,2020-05-25T21:53:22Z,2020-05-26T17:00:17Z
54,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3986,closed,2020-05-27T00:46:40Z,2020-05-27T05:57:23Z
55,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4000,closed,2020-05-28T21:01:30Z,2020-06-01T22:46:09Z
56,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4011,closed,2020-06-01T06:37:01Z,2020-06-18T00:21:50Z
57,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3960,closed,2020-05-20T19:25:37Z,2020-06-18T00:39:08Z
58,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3935,closed,2020-05-15T17:06:38Z,2020-06-18T00:39:08Z
59,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4125,closed,2020-06-18T14:31:34Z,2020-06-18T14:59:32Z
60,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4130,closed,2020-06-18T23:55:24Z,2020-06-19T00:29:18Z
61,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4105,closed,2020-06-17T17:59:30Z,2020-06-19T00:29:17Z
62,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4132,closed,2020-06-19T04:54:58Z,2020-06-19T05:48:21Z
63,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4123,closed,2020-06-18T14:27:38Z,2020-06-19T17:56:22Z
64,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4128,closed,2020-06-18T17:39:57Z,2020-06-19T21:25:40Z
65,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4126,closed,2020-06-18T15:20:05Z,2020-06-20T20:38:09Z
66,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4138,closed,2020-06-20T00:17:33Z,2020-06-22T18:39:16Z
67,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4159,closed,2020-06-23T15:51:21Z,2020-06-23T16:35:53Z
68,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4160,closed,2020-06-23T16:58:08Z,2020-06-23T17:52:06Z
69,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4,closed,2018-01-17T23:34:54Z,2018-01-17T23:35:16Z
70,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4163,closed,2020-06-23T22:23:14Z,2020-06-23T22:55:39Z
71,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4,closed,2018-01-17T23:34:54Z,2018-01-17T23:35:16Z
72,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4167,closed,2020-06-24T15:49:39Z,2020-06-24T16:49:39Z
73,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4141,closed,2020-06-21T05:24:09Z,2020-06-25T03:02:34Z
74,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3960,closed,2020-05-20T19:25:37Z,2020-06-18T00:39:08Z
75,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3935,closed,2020-05-15T17:06:38Z,2020-06-18T00:39:08Z
76,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4170,closed,2020-06-25T16:38:26Z,2020-06-25T18:52:33Z
77,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4168,closed,2020-06-25T05:27:51Z,2020-06-25T19:07:38Z
78,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4181,closed,2020-06-26T21:21:46Z,2020-06-26T22:40:05Z
79,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4136,closed,2020-06-19T18:25:08Z,2020-06-27T04:53:06Z
80,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4083,closed,2020-06-17T08:19:16Z,2020-06-29T00:58:32Z
81,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4150,closed,2020-06-22T21:35:11Z,2020-06-29T17:16:50Z
82,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4190,closed,2020-06-29T13:20:55Z,2020-06-29T20:33:55Z
83,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4127,closed,2020-06-18T17:38:51Z,2020-06-29T20:34:09Z
84,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4176,closed,2020-06-26T10:40:25Z,2020-06-30T01:38:47Z
85,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4134,closed,2020-06-19T18:20:19Z,2020-06-30T02:12:49Z
86,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4196,closed,2020-06-29T21:42:11Z,2020-06-30T14:09:26Z
87,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4135,closed,2020-06-19T18:23:49Z,2020-06-30T17:19:39Z
88,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4151,closed,2020-06-22T23:28:43Z,2020-06-30T17:20:02Z
89,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4177,closed,2020-06-26T13:21:24Z,2020-06-30T17:54:59Z
90,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4189,closed,2020-06-29T12:59:50Z,2020-06-30T18:50:41Z
91,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4178,closed,2020-06-26T14:00:13Z,2020-06-30T18:51:33Z
92,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4195,closed,2020-06-29T21:12:02Z,2020-06-30T18:53:47Z
93,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#3813,closed,2020-04-27T12:03:25Z,2020-06-30T23:52:56Z
94,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4202,closed,2020-06-30T17:02:10Z,2020-07-01T01:13:31Z
95,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4183,closed,2020-06-26T23:47:45Z,2020-07-01T01:17:04Z
96,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4147,closed,2020-06-22T17:37:57Z,2020-07-01T02:15:24Z
97,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4162,closed,2020-06-23T17:39:30Z,2020-07-01T02:19:59Z
98,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4171,closed,2020-06-25T18:01:56Z,2020-07-01T02:21:50Z
99,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4137,closed,2020-06-19T18:31:15Z,2020-07-01T14:19:11Z
100,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4214,closed,2020-07-01T12:55:41Z,2020-07-01T14:48:46Z
101,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4145,closed,2020-06-22T11:22:59Z,2020-07-01T18:13:02Z
102,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4075,closed,2020-06-16T07:50:36Z,2020-07-01T18:21:06Z
103,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4215,closed,2020-07-01T17:25:43Z,2020-07-01T18:32:25Z
104,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4229,closed,2020-07-06T19:03:59Z,2020-07-06T22:02:21Z
105,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4224,closed,2020-07-03T19:37:03Z,2020-07-07T15:25:05Z
106,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4231,closed,2020-07-06T19:07:11Z,2020-07-07T17:05:05Z
107,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4235,closed,2020-07-07T18:22:27Z,2020-07-07T18:52:27Z
108,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4232,closed,2020-07-07T04:15:35Z,2020-07-07T19:04:58Z
109,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4236,closed,2020-07-07T19:16:19Z,2020-07-07T20:53:31Z
110,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4237,closed,2020-07-07T19:29:17Z,2020-07-08T00:35:23Z
111,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4210,closed,2020-07-01T07:21:01Z,2020-07-08T00:42:24Z
112,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4222,closed,2020-07-03T03:42:27Z,2020-07-08T00:44:34Z
113,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4242,closed,2020-07-08T01:18:55Z,2020-07-08T03:40:54Z
114,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4241,closed,2020-07-08T00:14:48Z,2020-07-08T03:40:54Z
115,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4243,closed,2020-07-08T01:34:23Z,2020-07-08T19:32:26Z
116,9825df042ad28440663130cd9e2e8b2a3685a501,"Wrap Convert.ToInt32 method to catch conversion error  (#4211)//* Double cancellation test: improve test////* Add OnPreBubble smartness to consult with QnA to decide whehter to allow interruptions.//If QnAMaker is interrupted end the dialog.////* Adaptive: Minor tweaks to CycleDetectionObserver. Clone from cache on non-loops, don't clone on loops - just stitch things together.////* nuget.client is a package which is no longer being updated, they replaced it with nuget.packaing which is many versions past the one we were using.//Worse, nuget.client had a bad prerelase package pushed in 2017 that breaks install adaptive into linqpad.//also fixed .dialog files which were not compliant to schema (missing actions node)////* Do NOT call TeamsInfo.getMember for the bot (#3923) (#3924)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Add interdependencies graph to readme (#3921)////* Add dependency graph////* Update README.md////* Update README.md////* Remove DependencyGraph folder////* Update graph title////* Update graph title 2////* Title tweak 3////* Fix path to graph////* Fix unit test for formatting numbers////On my machine, this unit test fails. The issue is that the expected value is incorrect. The `CurrencyGroupSeparator` for `fr-FR` is `\x202F` not `00a0`////* Fix some typos in the same test////* Slack sets timestamp as unix time in seconds////If the server validates that the timestamp is recent to prevent replay attacks, then this would fail.////* convert datetime object from memory to iso timestamp////* revert////* supoort datetime object input////* Update to link to the new 4.9.1 dependency graph (#3929)////* Remove functional-test-setup-steps.yml call from botbuilder-dotnet-sign.yml. (#3948)////* add test cases////* change error message////* modify isDateTime function////* Add badges for Win functional tests and Linux functional tests (#3950)////* Maintain the high priority and independence of multiline (#3944)////* Support long/int64 in number constant (#3912)////* add long support////* just use long to parse integer////* revert int parse////* add unit tests////* [LG] Make template name format consistent with function name format (#3946)////* Restrict the format of templateName////* typo////* modify the message////* Remove path excludes from triggers (#3951)////* Eliminate path-based excludes for CI build checks required by github////* Add comment////* Fixes BadRequest message in Teams (#3966) (#3967)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Hardened prompts (#3949)////* hardened prompts////* rename message to utterance////* Update to support object defaultOperations.////* support expression in debug evaluate////* Improve handling of PROPERTYName.////* Add property to EntityInfo.////* Fix assignment swallowing.////* Fix issue where loop stops early.////* Udpate generator unit tests to include operations and arrays.////* Move strings to constants.////* Normalize line endings in assert.////* [Cherry pick from 4.9] Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3983)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Update README.md (#3999)////* [Expression] Add DateTimeDiff prebuilt function (#3934)////* add DateTimeDiff prebuilt function////* remove unnecessary import////* fix the error message////* modify input types////* Add sentenceCase && titleCase builtin function (#3994)////* add sentanceCase builtin function////* add titleCase function////* refine////* refine sentenceCase////* add EOL builtin function (#3992)////* Make data and locale optional in multilingual LG (#3932)////* fix datetime timezone (#4002)////* Change Platform to TestCategory (#3991)////* Change error messages in pre-built functions to make the descriptions more accurate (#3987)////* modify error messages////* fix typos////* fix spelling of time zone////* fix comments////* remove redundent words////* fix grammer issue////* Add ticksToDays, ticksToHours, ticksToMinutes pre-built functions (#3988)////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* add TicksToDays, TicksToHours, TicksToMinutes prebuilt functions////* resolve test fails////* modify return type////* make ticksperday, etc as constant////* Don't throw exception on unhandled VersionChangeDetected event (#4000) (#4015)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>////* Adjust grammar to improve LG parsing performance (#4021)////* fix LG perf issue////* init////* Calling an event driven dialog did not work because passed in options would override the initial setup of dialog memory.////* Refine template loop detection to enable recursive functions (#4012)////* refine loop detection////* make GetId depends on Version of IMemory////* refine ID////* add self loop test////* cover nullable situation////* enable recursive functions in Expander////* Reduce the recursion stack depth to pass MacOS test////* init error refine////* support null in isObject and isString (#4024)////* add expression parse cache (#4026)////* add source info into error msg////* remove magic string////* ignore line numner of diagnostic for inline text////* rename,FakeTemplateId -> InlineTemplateId////* add dialogContext memory scope////* fix corner case of expander////* move activity triggers into folder////* First cut of Teams adaptive library////* fix child scope and moar unit tests////* [LG] Move ""EXPRESSION"" in LG from lexer to parser (#3898)////* init////* maintain the orginal runtime error////* init////* add test////* add tests////* updatee tests.schema////* update schema////* Make Activity valid for there is only channelData////* Add floor, ceiling, round pre-built functions (#4017)////* add floor, ceiling, round////* fix comments////* modify numberTransform method////* fix comments////* fix strict mode issue in expander////* adjust test cases////* add expandText LG function////* change Regex replace with EvaluateText////* Update doc XML (#4031)////- Fixes warnings in ref doc build, primarily.//- Also fixes a small amount of wording and grammar.////* Sets warnings as errors and adds FxCop analyzer to Schema project. (#4061)////* Configured TreatWarningsAsErrors on all projects in the libraries folder except for Microsoft.Bot.Builder.Dialogs.Adaptive.Testing (that needs to be addressed separatelly).//Created Directory.Build.props for FunctionalTests and Tests to manage excludes for the projects in those folders.//Added NoWarn properties for documentation on each project (these will be addressed by another issue).//Fixed long hanging fruit warnings.//Added Roslyn FxCop analyzer to Microsoft.Bot.Schema and fixed violation or excluded them using #pragma.////* Fixed binary compat issues////* Fixed more binary compat issues////* Add ContinueConversation event activity support to BotFrameworkAdapter//Add PostActivityAsync method to BotFrameworkHttpClient to make it easy to post EventActivity to your bot//Add ContinueConversationLater action to BotBuilder.Azure//Add unit tests, etc.////* fix project dependencies////* update tests.schema////* add 'new' attribute to kind////* reverted changes to BotFrameworkAdapter, realized they weren't required.////* fix unit test logic.////* update declearitve tests////* disable merge test on linux/mac////* only build schema file on windows////* add http body expression evaluate////* add body is null condition////* apply list in concat////* add tests////* rename to align with teamshandler names////* renamed $kind namespace to ""Teams""////* change kind namespace for ContinueConversationLater to AzureQueues////* Add community docs (#4067)////* Added PR template, Code of Conduct doc and Contributing guidance doc as per community guidelines.////* Amends for code of conduct////* Readded deleted files////* Fix httprequest for string content,//add mocked httprequest unit tests for HttpRequest////* add header binding to unit test////* fix linux breaks////* Refactor of Slack adapter to address dependency on 3rd party library (#4046)////* Further WIP////* - Removed unused files//- Updated tests//- Removed remaining dependencies on client model classes////* Remove redundant error supression////* Added missing classes as per PR #3760////* Fix up namespaces for model classes////* Fix up tests////* Fixed warnings on build////* Removed redundant XML comment////* Fix HtpRequest tests on linux/mac (\r\n vs \n )////* change order of using////* changes based on PR feedback, copyright and disposing of response////* Fix functional test builds to not fail on code analysis errors (#4074)////* Add --no-build parameter to dotnet publish////* Change dotnet publish argument to ""-p RunCodeAnalysis=False""////* Fix arg to ""-p:RunCodeAnalysis=False""////* Add arg ""/p:StyleCopEnabled=false""////* Fix case of false in -p:RunCodeAnalysis=false /p:StyleCopEnabled=false////* Set 4 command line properties////* Set --verbosity diag////* Remove $(SolutionDir) references, as they don't work in ""dotnet publish"".////* Clean up args////* Set -p:CodeAnalysisRuleSet=''////* Revert .csproj to use $(SolutionDir).////* Add SolutionDir var////* Fix quotes////* Clean up////* Add comment////* Update the other pipelines////* Add aadGroupId to TeamInfo (#4078)////* Add aadGroupId to TeamInfo////* Remove additional constructor from TeamInfo////* address Gabo's feedback////* add HttpRequestMock and test////* Update OAuthInput.cs////* Enables FxCop Analyzer for the Connector library (#4110)////* Enables FxCop Analyzer for the Connector library and addressed violations.//Marked OAuthClientOld as obsolete.//Makred a lot of private methods in AdalAuthenticator as statics (that's the big diff here)////* Address Carlos feedback.////* Added intial cut at daily build spec////* Migrates Tests tests to Xunit (#4082)////* migrating teams tests////* adding skills////* Updates to Daily Build Proposal////* Porting Adapters folder to Xunit (#4115)////* migrating testadapters to xunit////* fixes #4107 migrating adapters folder to xunit//// Please enter the commit message for your changes. Lines starting////* disable codeSignValidationInjection task in main CI (#4056)////* Merge 4.9 back to master (#4032)////* Do NOT call TeamsInfo.getMember for the bot (#3923)////* Do NOT call TeamsInfo.getMember for the bot////* Add TestConversationUpdateBotTeamsMemberAdded////* Declarative: disable cycle detection to reduce release risk////* Update Nuget.Client to resolve circular reference exceptions (#3964)////* Fixes BadRequest message in Teams (#3966)////* Added check to ensure we don't send EoC when a skill is done and we are at the root bot.//Updated tests to handle this case and removed duplicated test after refactoring.//Fixed some typos and trace message names.////* Auth: Tighten JWT validation of channel-issued tokens with certificate signature (#3978)////* Auth: Tighten JWT validation of channel issued tokens with certificate signature////* Fix comment in test////* Auth improvements: add test category and adjust linux build settings////* Auth tests: cleanup self-signed certs after tests////* Change filter to ""TestCategory"". (#3986)////* Don't throw exception on unhandled VersionChangeDetected event (#4000)////* disable throwing exception if dialog change not handled////* remove trace from versionChanged////Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>////* Update LuisExtensions.cs (#4011)////* Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)////* AnswerSpanRequest property in Request.////* Answer span changes for request and response data sstructures////* Request and Result object conversion////* datatype definition change from boolean to bool for enable AnswerSpan////* Text////* spaces////* MRCEnable instead of AnswerSpanRequest////* Answerspan text set to answer for MRC////* Mock changes////* Review comments changes////* Tests for both and precise////* Update GetQnAPromptsCard invocation in tests////* GetQnAPromptsContentCard method////* Review comments////* Request changes////* refactoring////* Refactoring Tests////* Tests refactoring for comments////* Added Copyright headers////* Modified comment text for review comment.////* Update QnAMakerDialog.cs////* document text modified.////* Copy right header formatting////* Remove unused import////* Revert ""Added Copyright headers""////This reverts commit b13d2ebdf428643a648c0711f642d74fd53813b8.////* Copyright header////* Comment modified for grammar and clarity////* Review comments////* For fixing assembly difference issue////* Revert ""For fixing assembly difference issue""////This reverts commit fdfcbe0c0e4ac1885f8d1f84b5267a2c1c94d662.////* For assemblies issue////* Added purpose of property in summary.////* Comments improved////* For Review comments////* For review comments////* Spellings Syntax////* Content corrections////* Content comments changes////* content request////* content changes////* Content changes for comments////* Content review updates////* Content changes////* content chagnes////* Revert enablePreciseAnswer to bool////* removing json property for enable preccise////* Reverting Recognizer changes////* schema change and BoolExpression////* Review comments////* initialization of EnablePreciseAnswer////* schema changes for Display Precise AnswerOnly////* BoolExpression for DisplayPreciseAnswerOnly////* bool property for displayPreciseAnswer////* Updated comments////* Null checks and CardEqualityComparer comments////* Undo contenttype change.////* format////* Final Commit////* Spaces formating.////* Indentation for schema files.////* update schema////* Make content type check more robust (#4125)////* If there is no utterance we should return no intents.////* update regexrecognizer to return no intents if there is no utterance just like LuisRecognizer.////* update oracle tests////* added custom isDialogActive function to adaptive assembly.////* add unit tests for EditActions AppendActions and EditAction InsertActions////* Migrating Schema to Xunit (#4130)////* migrating tests to Xunit////* fixes #4105 removing MSTest packages////* fix expandText return type error (#4132)////* fix expandText return type error////* fix////* Add hasPendingActions() function which returns true if there is an executing plan for the current active adaptive dialog.////* add declarative function test for isDialogActive////* Updates to Facebook Adapter (#4123)////* - Updated Facebook Adapter to accept Facebook Adapter Options, with an optional param to override the client.//- Update code docs and removed error supression for code doc warnings////* Updates following review////* add isActionActive() alias for isDialogActive()//add unit test for multiple editactions////* Josh/botbuilder tests (#4128)////* migrating teams tests////* adding skills////* fixing rebase////* resolving individual xunit functions////* fixing missed params////* removing TestContext from util////* removing MSTest packages////* deleting test folder before tests run////* adding file resets to other test files////* cleaning up assert logic////* change to xunit////* Add ToAttachment method for OAuthCard (#4126)////* Add OAuthCards ToAttachment method////* Add unit tests for ToAttachment methods////* Refactor tests:////- Replace MSTest with Xunit//- Remove Bot.builder project dependency////* Add empty recognizer support for composer scenario////* Porting adaptiveexpressions tests to xunit (#4138)////* porting tests to xunit////* Removing packages////* * Fix switch to not treat expression errors as exceptions but instead as false condition//* Fix switch to treat ambiguity in string case definition more robustly.////* Add DialogException, catch and throw////* Add constants for dialogcontext paths////* make dialogException calculate full contextual stack frame////* only keep dialog ids in exception, state is duplicate of data in the state bag////* removed dialogException and use Exception.Data to annotate exceptions with dialog context metadata.////* Updates to readme for accuracy, consistency across languages and consolidating wiki content. (#4159)////* Fix Slack functional test build (#4160)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Minor updates to proposal for review.////* Markdown fixes for formatting////* Fix 3 functional test builds (#4163)////* add az group create////* Switch to template-with-preexisting-rg.json////* Fix template args for az deployment sub create////* Fix arg appServicePlanLocation////* Try ""call az deployment group create""////* Fix call az deployment group create #4////* Fix facebook pipeline////* Fix facebook call az deployment group create////* Fix template reference////* Fix webex pipeline////* Drop --location ""westus""////* Fix windows func test build////* Fix botgroup////* Remove slack refs from windows template////* Add message to ""Set up directline keys""////* Change endpoint to mybot from messages (#4167)////* Added FxCop to Microsoft.BotBuilder and addressed errors. (#4141)////* Added FxCop to Microsoft.BotBuilder and addressed errors.//Enabled the SX1309 (FieldNamesShouldBeginWithUnderscores) stylecop rule and addressed the violations on BotBuilder but excluded it from the other projects for now to avoid collisions.//Enabled CA1309 (Use ordinal StringComparison) to the main ruleset and addressed violations.//Added ($NoWarn) to root dir props to make sure tests take this value.////* Enabled AsyncUsage analyzer and fixed violations wherever ir was possible.////* Refactore Task.Run usages to await/async equivalents.////* Updated Adapters folder to use FxCop 3.0////* Refactored ShowTypingMiddleware to avoid using Task.Run so we don't create unnecessary threads.////* Updated constructor to use _httpClient field instead of the expression.////* Revert ""Fixes issue #3960 [QnAMaker] [DotNet] Implementing QnAMaker's precise answering capability as an additional feature for BotFramework users (#3935)"" (#4170)////This reverts commit 48461190c2e52b123d15aebceecbeb1711091b5a.////* Enabled FxCop on the Dialogs project and Integration folder (#4168)////* Enabled FxCop on the Dialogs project and fixed errors.////* Enabled FxCop and Async usage analyzers on the integration folder projects usinga BuildProps file and fixed errors.////* Fixed some FxCop issues for WebApi projects that only show when targetting Windows in the build.//Added reference to editorconfig to the sln file to make it easier to maintain.////* Port LanguageGeneration to Xunit (#4181)////* adding xunit packages////* porting language generation tests to xunit////* removing MS Test////* Add Obsolete attribute to Microsoft.Bot.Configuration.LuisService (#4136)////* Update////* Further improve LG's performance (#4083)////* add templateBodyCache////* update////* re-do updateTemplate////* improve perf for addTemplate and DeleteTemplate////* add more tests and remove cache////* adjust test////* adjust////* fix environment newline issue////* try fix ci error////* add tests////* extract methods////* refine////* fix////* revert////* renaming and add more tests////* add more comments////* extract range offset////* properly escape slashes in constant strings////* Add LinkToMessage in MessageActionsPayload class (#4150)////* Add LinkToMessage property////* Add unit tests for MessageActionsPayload class////* Apply feedback in unit test and constructor////* Add assertion of LinkToMessage property in test.////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* update tests for tab roundtrip too////* Add missing code docs for Configuration lib (#4190)////* Add missing code docs for the webex adapter (#4127)////* Extend 'getProperty' builtin function to support accessing top memory. (#4176)////* enhance getProperty////* add more tests////* adjust the error message////* Add logging to BotFrameworkHttpClient.PostActivityAsync() (#4134)////* Add logging to BotFrameworkHttpClient.PostActivityAsync()////* Adding message logged message lost after refactor.////* add Microsoft.Test.SettingsPropertiesMock with test////* refactor Convert.ToInt32////* refactor Convert.ToInt32////* update & add schema////* Remove references to MissingMemberException (#4196)////* Porting Transcript tests to Xunit (#4135)////* fixing rebase////* removing MSTest packages////* rebasing////* readding visualstuio package////* Refactoring AI Luis V3 to Xunit (#4151)////* refactoring to xunit////* removing MS TEst////* Remove Slack from the list of channels that support Suggested Actions (#4177)////* Update missing code docs for the Azure library (#4189)////* Move TelemetryClient property to DialogContainer (#4178)////* Add ImageAltText to CardAction (#4195)////* [Adaptive] Add Binary Data Parsing For Http Request (#3813)////* add binary data support to http request////* fix comment////* fix space////* update schema////* binary type return bytes directly////* fix compile error////* add ut for response types.////* Add Teams Channel Restored event (#4202)////* Add Teams' ChannelRestored event////* Add test for OnTeamsChannelRestoredAsync method////* Add missing documentation for TeamsActivityHandler////Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>////* Porting Adaptive Templates to Xunit (#4183)////* porting tests to xunit////* removing unused file////* removing MS Test////* registering components once per test suite////* Add missing code docs for the AI libraries (LUIS / QnA) (#4147)////* Add missing code docs for the AI libraries (LUIS / QnA)////* Manually fixed some merge conflicts to match master////* Fixed other naming errors for new variables that came with the merge////Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>////* doc cleanup (#4162)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>////* [Engineering] Update codeowners (#4171)////* updated codeowners// - @microsoft/bb-dotnet// - @microsoft/bf-admin// - @microsoft/bf-adaptive////* add comments and more GH Teams to CODEOWNERS////* change normalizeDateTime and add tests////* change normalizeDateTime and add tests////* add test case for formatNumber////* add test case for formatNumber////* Add missing code docs to integration libraries (#4137)////* Added code docs to AppInsights Core lib////* Add missing code docs to integration libraries////Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>////* Update Facebook, Slack, Webex adapters (#4214)////* Update Facebook, Slack, Webex adapters to follow pattern from Twilio adapter////* Tweak exception messages////* add Microsoft.Test.UserTokenMock & tests (#4145)////* add Microsoft.Test.UserTokenMock & tests////* give it more time////* use pretty approach instead of MockData////* [Expression] Add merge prebuilt function for merging JSON object (#4075)////* add merge function////* remove support of JArray in merge////* fix some format and error msgs////* fix two error msgs////* fix typos////* add using////* Remove preview tag from adapters (#4215)////* Remove preview tag from adapters////* Updated to include package version property////* use invariant culture////* fix merge and allow either 00A0 or 202F in fr-fr numbers////* use WrapDialogForPropertyMocks for all kinds of properties////add more tests////* add comment////* Add null check for locale into MultiLanguageRecognizer////* fix (#4229)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* add directlinespeech support to prompts (#4224)////* fix (#4231)////Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>////* Add EndOfConversationCodes to EndOfConversation activity from Skill (#4235)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body. (#4232)////Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated FN Test projects to match samples (#4236)////* Fixes issue with InvokeResponse<T> hidding the underlying value for Body.//Makes methods ins SkillHttpClient virtual so they can be mocked in tests.//Updated BotFrameworkClient to use a deepclone of the activity rather than try/catch/finally to simply code and make sure we don't risk altering the original activity while the async request is being executed.//Improved test coverage for BotFrameworkClient and SkillHttpClient.////* Updated Skill test projects to match samples.////* Deleted composer testing project////* Update botbuilder-dotnet-sign.yml for Azure Pipelines////Make Nightly build have 4-digit year////* Update CODEOWNERS (#4237)////* Streamline codeowners////* Add Connector.Authentication code owners////* Assign bf-dialogs to Microsoft.Bot.Builder.Dialogs////* additional updates to codeowners////* Refine ActivityFactory (#4210)////* refine activityFactory////* small property fixc////* Refactor AdaptiveExpressions method GetStandardFunctions() (#4222)////* init////* init////* update////* add copyright////* remove builtin alias////* fix error////* fix error////* remove unused using////* remove unused code////* add comments////* fix comments////* fix small access modifier////* add missing document////* fix typo////* Clm/fix nuget versions in adapaters (#4242)////* Fixes #4241////* Update ReleasePackageVersion to pickup version numbers////* Updated checma files to point to the new friendly https://schemas.botframework.com/schemas/component/v1.0/component.schema URL (#4243)////* Add code owners for /**/*.schema (#4249)////* rework after refactor builtin functions////* rework after refactor builtin functions////Co-authored-by: Carlos Castro <ccastro@microsoft.com>//Co-authored-by: Tom Laird-McConnell <tomlm@microsoft.com>//Co-authored-by: Carlos Castro <carlosscastro@users.noreply.github.com>//Co-authored-by: Eric Dahlvang <v-eridah@microsoft.com>//Co-authored-by: BruceHaley <v-bruhal@microsoft.com>//Co-authored-by: Phil Haack <haacked@gmail.com>//Co-authored-by: Lu Han <32191031+luhan2017@users.noreply.github.com>//Co-authored-by: Hongyang Du (hond) <hond@microsoft.com>//Co-authored-by: Gabo Gilabert <gabog@users.noreply.github.com>//Co-authored-by: Michael Richardson <40401643+mdrichardson@users.noreply.github.com>//Co-authored-by: Chris McConnell <chrimc@microsoft.com>//Co-authored-by: xieofxie <xieofxie@126.com>//Co-authored-by: Monica Rivera <44449640+mrivera-ms@users.noreply.github.com>//Co-authored-by: Hongyang Du <1990512dhy@163.com>//Co-authored-by: Fei Chen <feich@microsoft.com>//Co-authored-by: Fei Chen <43032123+feich-ms@users.noreply.github.com>//Co-authored-by: Jonathan Fingold <jonathan.m.fingold@gmail.com>//Co-authored-by: Qi Kang <qika@microsoft.com>//Co-authored-by: Gary Pretty <gary@garypretty.co.uk>//Co-authored-by: Chris Mullins <cmullins@gmail.com>//Co-authored-by: Josh <50158775+Virtual-Josh@users.noreply.github.com>//Co-authored-by: Steven Gum <14935595+stevengum@users.noreply.github.com>//Co-authored-by: vipeketi <58211229+vipeketi@users.noreply.github.com>//Co-authored-by: Cecilia Avila <44245136+ceciliaavila@users.noreply.github.com>//Co-authored-by: Chris Mullins <cleemullins@users.noreply.github.com>//Co-authored-by: Denise Scollo <dens.scollo@gmail.com>//Co-authored-by: Cecilia Avila <cecilia.avila@southworks.com>//Co-authored-by: Kyle Delaney <kyled@aditiconsulting.com>//Co-authored-by: Eric Dahlvang <ericdahlvang@outlook.com>//Co-authored-by: Qi Kang <kangqidev@gmail.com>//Co-authored-by: Gabo Gilabert <ggilaber@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwack@hotmail.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-KG5GAD9.fareast.corp.microsoft.com>//Co-authored-by: johnataylor <johtaylo@microsoft.com>//Co-authored-by: Vishwac Sena Kannan <vishwacsenakannan@MININT-G8HVI76.redmond.corp.microsoft.com>//Co-authored-by: Eric Dahlvang <EricDahlvang@gmail.com>",microsoft/botbuilder-dotnet,#4249,closed,2020-07-08T19:54:54Z,2020-07-08T20:49:53Z
117,5d082ffe67c9714472dcc1548c6b5b7b60780d2c,"Helix Testing (#6992)//Use the Helix testing orchestration framework to run our Terminal LocalTests and Console Host UIA tests.////## References//#### Creates the following new issues://- #7281 - re-enable local tests that were disabled to turn on Helix//- #7282 - re-enable UIA tests that were disabled to turn on Helix//- #7286 - investigate and implement appropriate compromise solution to how Skipped is handled by MUX Helix scripts////#### Consumes from://- #7164 - The update to TAEF includes wttlog.dll. The WTT logs are what MUX's Helix scripts use to track the run state, convert to XUnit format, and notify both Helix and AzDO of what's going on.////#### Produces for://- #671 - Making Terminal UIA tests is now possible//- #6963 - MUX's Helix scripts are already ready to capture PGO data on the Helix machines as certain tests run. Presuming we can author some reasonable scenarios, turning on the Helix environment gets us a good way toward automated PGO.////#### Related://- #4490 - We lost the AzDO integration of our test data when I moved from the TAEF/VSTest adapter directly back to TE. Thanks to the WTTLog + Helix conversion scripts to XUnit + new upload phase, we have it back!////## PR Checklist//* [x] Closes #3838//* [x] I work here.//* [x] Literally adds tests.//* [ ] Should I update a testing doc in this repo?//* [x] Am core contributor. Hear me roar.//* [ ] Correct spell-checking the right way before merge.////## Detailed Description of the Pull Request / Additional comments//We have had two classes of tests that don't work in our usual build-machine testing environment://1. Tests that require interactive UI automation or input injection (a.k.a. require a logged in user)//2. Tests that require the entire Windows Terminal to stand up (because our Xaml Islands dependency requires 1903 or later and the Windows Server instance for the build is based on 1809.)////The Helix testing environment solves both of these and is brought to us by our friends over in https://github.com/microsoft/microsoft-ui-xaml.////This PR takes a large portion of scripts and pipeline configuration steps from the Microsoft-UI-XAML repository and adjusts them for Terminal needs.//You can see the source of most of the files in either https://github.com/microsoft/microsoft-ui-xaml/tree/master/build/Helix or https://github.com/microsoft/microsoft-ui-xaml/tree/master/build/AzurePipelinesTemplates////Some of the modifications in the files include (but are not limited to) reasons like://- Our test binaries are named differently than MUX's test binaries//- We don't need certain types of testing that MUX does.//- We use C++ and C# tests while MUX was using only C# tests (so the naming pattern and some of the parsing of those names is different e.g. :: separators in C++ and . separators in C#)//- Our pipeline phases work a bit differently than MUX and/or we need significantly fewer pieces to the testing matrix (like we don't test a wide variety of OS versions).////The build now runs in a few stages://1. The usual build and run of unit tests/feature tests, packaging verification, and whatnot. This phase now also picks up and packs anything required for running tests in Helix into an artifact. (It also unifies the artifact name between the things Helix needs and the existing build outputs into the single `drop` artifact to make life a little easier.)//2. The Helix preparation build runs that picks up those artifacts, generates all the scripts required for Helix to understand the test modules/functions from our existing TAEF tests, packs it all up, and queues it on the Helix pool.//3. Helix generates a VM for our testing environment and runs all the TAEF tests that require it. The orchestrator at helix.dot.net watches over this and tracks the success/fail and progress of each module and function. The scripts from our MUX friends handle installing dependencies, making the system quiet for better reliability, detecting flaky tests and rerunning them, and coordinating all the log uploads (including for the subruns of tests that are re-run.)//4. A final build phase is run to look through the results with the Helix API and clean up the marking of tests that are flaky, link all the screenshots and console output logs into the AzDO tests panel, and other such niceities.////We are set to run Helix tests on the Feature test policy of only x64 for now. ////Additionally, because the set up of the Helix VMs takes so long, we are *NOT* running these in PR trigger right now as I believe we all very much value our 15ish minute PR turnaround (and the VM takes another 15 minutes to just get going for whatever reason.) For now, they will only run as a rolling build on master after PRs are merged. We should still know when there's an issue within about an hour of something merging and multiple PRs merging fast will be done on the rolling build as a batch run (not one per).////In addition to setting up the entire Helix testing pipeline for the tests that require it, I've preserved our classic way of running unit and feature tests (that don't require an elaborate environment) directly on the build machines. But with one bonus feature... They now use some of the scripts from MUX to transform their log data and report it to AzDO so it shows up beautifully in the build report. (We used to have this before I removed the MStest/VStest wrapper for performance reasons, but now we can have reporting AND performance!) See https://dev.azure.com/ms/terminal/_build/results?buildId=101654&view=ms.vss-test-web.build-test-results-tab for an example. ////I explored running all of the tests on Helix but.... the Helix setup time is long and the resources are more expensive. I felt it was better to preserve the ""quick signal"" by continuing to run these directly on the build machine (and skipping the more expensive/slow Helix setup if they fail.) It also works well with the split between PR builds not running Helix and the rolling build running Helix. PR builds will get a good chunk of tests for a quick turn around and the rolling build will finish the more thorough job a bit more slowly.////## Validation Steps Performed//- [x] Ran the updated pipelines with Pull Request configuration ensuring that Helix tests don't run in the usual CI//- [x] Ran with simulation of the rolling build to ensure that the tests now running in Helix will pass. All failures marked for follow on in reference issues.",microsoft/terminal,#6992,closed,2020-07-21T17:55:44Z,2020-08-18T18:23:25Z
118,5d082ffe67c9714472dcc1548c6b5b7b60780d2c,"Helix Testing (#6992)//Use the Helix testing orchestration framework to run our Terminal LocalTests and Console Host UIA tests.////## References//#### Creates the following new issues://- #7281 - re-enable local tests that were disabled to turn on Helix//- #7282 - re-enable UIA tests that were disabled to turn on Helix//- #7286 - investigate and implement appropriate compromise solution to how Skipped is handled by MUX Helix scripts////#### Consumes from://- #7164 - The update to TAEF includes wttlog.dll. The WTT logs are what MUX's Helix scripts use to track the run state, convert to XUnit format, and notify both Helix and AzDO of what's going on.////#### Produces for://- #671 - Making Terminal UIA tests is now possible//- #6963 - MUX's Helix scripts are already ready to capture PGO data on the Helix machines as certain tests run. Presuming we can author some reasonable scenarios, turning on the Helix environment gets us a good way toward automated PGO.////#### Related://- #4490 - We lost the AzDO integration of our test data when I moved from the TAEF/VSTest adapter directly back to TE. Thanks to the WTTLog + Helix conversion scripts to XUnit + new upload phase, we have it back!////## PR Checklist//* [x] Closes #3838//* [x] I work here.//* [x] Literally adds tests.//* [ ] Should I update a testing doc in this repo?//* [x] Am core contributor. Hear me roar.//* [ ] Correct spell-checking the right way before merge.////## Detailed Description of the Pull Request / Additional comments//We have had two classes of tests that don't work in our usual build-machine testing environment://1. Tests that require interactive UI automation or input injection (a.k.a. require a logged in user)//2. Tests that require the entire Windows Terminal to stand up (because our Xaml Islands dependency requires 1903 or later and the Windows Server instance for the build is based on 1809.)////The Helix testing environment solves both of these and is brought to us by our friends over in https://github.com/microsoft/microsoft-ui-xaml.////This PR takes a large portion of scripts and pipeline configuration steps from the Microsoft-UI-XAML repository and adjusts them for Terminal needs.//You can see the source of most of the files in either https://github.com/microsoft/microsoft-ui-xaml/tree/master/build/Helix or https://github.com/microsoft/microsoft-ui-xaml/tree/master/build/AzurePipelinesTemplates////Some of the modifications in the files include (but are not limited to) reasons like://- Our test binaries are named differently than MUX's test binaries//- We don't need certain types of testing that MUX does.//- We use C++ and C# tests while MUX was using only C# tests (so the naming pattern and some of the parsing of those names is different e.g. :: separators in C++ and . separators in C#)//- Our pipeline phases work a bit differently than MUX and/or we need significantly fewer pieces to the testing matrix (like we don't test a wide variety of OS versions).////The build now runs in a few stages://1. The usual build and run of unit tests/feature tests, packaging verification, and whatnot. This phase now also picks up and packs anything required for running tests in Helix into an artifact. (It also unifies the artifact name between the things Helix needs and the existing build outputs into the single `drop` artifact to make life a little easier.)//2. The Helix preparation build runs that picks up those artifacts, generates all the scripts required for Helix to understand the test modules/functions from our existing TAEF tests, packs it all up, and queues it on the Helix pool.//3. Helix generates a VM for our testing environment and runs all the TAEF tests that require it. The orchestrator at helix.dot.net watches over this and tracks the success/fail and progress of each module and function. The scripts from our MUX friends handle installing dependencies, making the system quiet for better reliability, detecting flaky tests and rerunning them, and coordinating all the log uploads (including for the subruns of tests that are re-run.)//4. A final build phase is run to look through the results with the Helix API and clean up the marking of tests that are flaky, link all the screenshots and console output logs into the AzDO tests panel, and other such niceities.////We are set to run Helix tests on the Feature test policy of only x64 for now. ////Additionally, because the set up of the Helix VMs takes so long, we are *NOT* running these in PR trigger right now as I believe we all very much value our 15ish minute PR turnaround (and the VM takes another 15 minutes to just get going for whatever reason.) For now, they will only run as a rolling build on master after PRs are merged. We should still know when there's an issue within about an hour of something merging and multiple PRs merging fast will be done on the rolling build as a batch run (not one per).////In addition to setting up the entire Helix testing pipeline for the tests that require it, I've preserved our classic way of running unit and feature tests (that don't require an elaborate environment) directly on the build machines. But with one bonus feature... They now use some of the scripts from MUX to transform their log data and report it to AzDO so it shows up beautifully in the build report. (We used to have this before I removed the MStest/VStest wrapper for performance reasons, but now we can have reporting AND performance!) See https://dev.azure.com/ms/terminal/_build/results?buildId=101654&view=ms.vss-test-web.build-test-results-tab for an example. ////I explored running all of the tests on Helix but.... the Helix setup time is long and the resources are more expensive. I felt it was better to preserve the ""quick signal"" by continuing to run these directly on the build machine (and skipping the more expensive/slow Helix setup if they fail.) It also works well with the split between PR builds not running Helix and the rolling build running Helix. PR builds will get a good chunk of tests for a quick turn around and the rolling build will finish the more thorough job a bit more slowly.////## Validation Steps Performed//- [x] Ran the updated pipelines with Pull Request configuration ensuring that Helix tests don't run in the usual CI//- [x] Ran with simulation of the rolling build to ensure that the tests now running in Helix will pass. All failures marked for follow on in reference issues.",microsoft/terminal,#7281,closed,2020-08-13T20:16:04Z,2020-08-18T21:50:03Z
119,5d082ffe67c9714472dcc1548c6b5b7b60780d2c,"Helix Testing (#6992)//Use the Helix testing orchestration framework to run our Terminal LocalTests and Console Host UIA tests.////## References//#### Creates the following new issues://- #7281 - re-enable local tests that were disabled to turn on Helix//- #7282 - re-enable UIA tests that were disabled to turn on Helix//- #7286 - investigate and implement appropriate compromise solution to how Skipped is handled by MUX Helix scripts////#### Consumes from://- #7164 - The update to TAEF includes wttlog.dll. The WTT logs are what MUX's Helix scripts use to track the run state, convert to XUnit format, and notify both Helix and AzDO of what's going on.////#### Produces for://- #671 - Making Terminal UIA tests is now possible//- #6963 - MUX's Helix scripts are already ready to capture PGO data on the Helix machines as certain tests run. Presuming we can author some reasonable scenarios, turning on the Helix environment gets us a good way toward automated PGO.////#### Related://- #4490 - We lost the AzDO integration of our test data when I moved from the TAEF/VSTest adapter directly back to TE. Thanks to the WTTLog + Helix conversion scripts to XUnit + new upload phase, we have it back!////## PR Checklist//* [x] Closes #3838//* [x] I work here.//* [x] Literally adds tests.//* [ ] Should I update a testing doc in this repo?//* [x] Am core contributor. Hear me roar.//* [ ] Correct spell-checking the right way before merge.////## Detailed Description of the Pull Request / Additional comments//We have had two classes of tests that don't work in our usual build-machine testing environment://1. Tests that require interactive UI automation or input injection (a.k.a. require a logged in user)//2. Tests that require the entire Windows Terminal to stand up (because our Xaml Islands dependency requires 1903 or later and the Windows Server instance for the build is based on 1809.)////The Helix testing environment solves both of these and is brought to us by our friends over in https://github.com/microsoft/microsoft-ui-xaml.////This PR takes a large portion of scripts and pipeline configuration steps from the Microsoft-UI-XAML repository and adjusts them for Terminal needs.//You can see the source of most of the files in either https://github.com/microsoft/microsoft-ui-xaml/tree/master/build/Helix or https://github.com/microsoft/microsoft-ui-xaml/tree/master/build/AzurePipelinesTemplates////Some of the modifications in the files include (but are not limited to) reasons like://- Our test binaries are named differently than MUX's test binaries//- We don't need certain types of testing that MUX does.//- We use C++ and C# tests while MUX was using only C# tests (so the naming pattern and some of the parsing of those names is different e.g. :: separators in C++ and . separators in C#)//- Our pipeline phases work a bit differently than MUX and/or we need significantly fewer pieces to the testing matrix (like we don't test a wide variety of OS versions).////The build now runs in a few stages://1. The usual build and run of unit tests/feature tests, packaging verification, and whatnot. This phase now also picks up and packs anything required for running tests in Helix into an artifact. (It also unifies the artifact name between the things Helix needs and the existing build outputs into the single `drop` artifact to make life a little easier.)//2. The Helix preparation build runs that picks up those artifacts, generates all the scripts required for Helix to understand the test modules/functions from our existing TAEF tests, packs it all up, and queues it on the Helix pool.//3. Helix generates a VM for our testing environment and runs all the TAEF tests that require it. The orchestrator at helix.dot.net watches over this and tracks the success/fail and progress of each module and function. The scripts from our MUX friends handle installing dependencies, making the system quiet for better reliability, detecting flaky tests and rerunning them, and coordinating all the log uploads (including for the subruns of tests that are re-run.)//4. A final build phase is run to look through the results with the Helix API and clean up the marking of tests that are flaky, link all the screenshots and console output logs into the AzDO tests panel, and other such niceities.////We are set to run Helix tests on the Feature test policy of only x64 for now. ////Additionally, because the set up of the Helix VMs takes so long, we are *NOT* running these in PR trigger right now as I believe we all very much value our 15ish minute PR turnaround (and the VM takes another 15 minutes to just get going for whatever reason.) For now, they will only run as a rolling build on master after PRs are merged. We should still know when there's an issue within about an hour of something merging and multiple PRs merging fast will be done on the rolling build as a batch run (not one per).////In addition to setting up the entire Helix testing pipeline for the tests that require it, I've preserved our classic way of running unit and feature tests (that don't require an elaborate environment) directly on the build machines. But with one bonus feature... They now use some of the scripts from MUX to transform their log data and report it to AzDO so it shows up beautifully in the build report. (We used to have this before I removed the MStest/VStest wrapper for performance reasons, but now we can have reporting AND performance!) See https://dev.azure.com/ms/terminal/_build/results?buildId=101654&view=ms.vss-test-web.build-test-results-tab for an example. ////I explored running all of the tests on Helix but.... the Helix setup time is long and the resources are more expensive. I felt it was better to preserve the ""quick signal"" by continuing to run these directly on the build machine (and skipping the more expensive/slow Helix setup if they fail.) It also works well with the split between PR builds not running Helix and the rolling build running Helix. PR builds will get a good chunk of tests for a quick turn around and the rolling build will finish the more thorough job a bit more slowly.////## Validation Steps Performed//- [x] Ran the updated pipelines with Pull Request configuration ensuring that Helix tests don't run in the usual CI//- [x] Ran with simulation of the rolling build to ensure that the tests now running in Helix will pass. All failures marked for follow on in reference issues.",microsoft/terminal,#7282,open,2020-08-13T20:16:29Z,
120,5d082ffe67c9714472dcc1548c6b5b7b60780d2c,"Helix Testing (#6992)//Use the Helix testing orchestration framework to run our Terminal LocalTests and Console Host UIA tests.////## References//#### Creates the following new issues://- #7281 - re-enable local tests that were disabled to turn on Helix//- #7282 - re-enable UIA tests that were disabled to turn on Helix//- #7286 - investigate and implement appropriate compromise solution to how Skipped is handled by MUX Helix scripts////#### Consumes from://- #7164 - The update to TAEF includes wttlog.dll. The WTT logs are what MUX's Helix scripts use to track the run state, convert to XUnit format, and notify both Helix and AzDO of what's going on.////#### Produces for://- #671 - Making Terminal UIA tests is now possible//- #6963 - MUX's Helix scripts are already ready to capture PGO data on the Helix machines as certain tests run. Presuming we can author some reasonable scenarios, turning on the Helix environment gets us a good way toward automated PGO.////#### Related://- #4490 - We lost the AzDO integration of our test data when I moved from the TAEF/VSTest adapter directly back to TE. Thanks to the WTTLog + Helix conversion scripts to XUnit + new upload phase, we have it back!////## PR Checklist//* [x] Closes #3838//* [x] I work here.//* [x] Literally adds tests.//* [ ] Should I update a testing doc in this repo?//* [x] Am core contributor. Hear me roar.//* [ ] Correct spell-checking the right way before merge.////## Detailed Description of the Pull Request / Additional comments//We have had two classes of tests that don't work in our usual build-machine testing environment://1. Tests that require interactive UI automation or input injection (a.k.a. require a logged in user)//2. Tests that require the entire Windows Terminal to stand up (because our Xaml Islands dependency requires 1903 or later and the Windows Server instance for the build is based on 1809.)////The Helix testing environment solves both of these and is brought to us by our friends over in https://github.com/microsoft/microsoft-ui-xaml.////This PR takes a large portion of scripts and pipeline configuration steps from the Microsoft-UI-XAML repository and adjusts them for Terminal needs.//You can see the source of most of the files in either https://github.com/microsoft/microsoft-ui-xaml/tree/master/build/Helix or https://github.com/microsoft/microsoft-ui-xaml/tree/master/build/AzurePipelinesTemplates////Some of the modifications in the files include (but are not limited to) reasons like://- Our test binaries are named differently than MUX's test binaries//- We don't need certain types of testing that MUX does.//- We use C++ and C# tests while MUX was using only C# tests (so the naming pattern and some of the parsing of those names is different e.g. :: separators in C++ and . separators in C#)//- Our pipeline phases work a bit differently than MUX and/or we need significantly fewer pieces to the testing matrix (like we don't test a wide variety of OS versions).////The build now runs in a few stages://1. The usual build and run of unit tests/feature tests, packaging verification, and whatnot. This phase now also picks up and packs anything required for running tests in Helix into an artifact. (It also unifies the artifact name between the things Helix needs and the existing build outputs into the single `drop` artifact to make life a little easier.)//2. The Helix preparation build runs that picks up those artifacts, generates all the scripts required for Helix to understand the test modules/functions from our existing TAEF tests, packs it all up, and queues it on the Helix pool.//3. Helix generates a VM for our testing environment and runs all the TAEF tests that require it. The orchestrator at helix.dot.net watches over this and tracks the success/fail and progress of each module and function. The scripts from our MUX friends handle installing dependencies, making the system quiet for better reliability, detecting flaky tests and rerunning them, and coordinating all the log uploads (including for the subruns of tests that are re-run.)//4. A final build phase is run to look through the results with the Helix API and clean up the marking of tests that are flaky, link all the screenshots and console output logs into the AzDO tests panel, and other such niceities.////We are set to run Helix tests on the Feature test policy of only x64 for now. ////Additionally, because the set up of the Helix VMs takes so long, we are *NOT* running these in PR trigger right now as I believe we all very much value our 15ish minute PR turnaround (and the VM takes another 15 minutes to just get going for whatever reason.) For now, they will only run as a rolling build on master after PRs are merged. We should still know when there's an issue within about an hour of something merging and multiple PRs merging fast will be done on the rolling build as a batch run (not one per).////In addition to setting up the entire Helix testing pipeline for the tests that require it, I've preserved our classic way of running unit and feature tests (that don't require an elaborate environment) directly on the build machines. But with one bonus feature... They now use some of the scripts from MUX to transform their log data and report it to AzDO so it shows up beautifully in the build report. (We used to have this before I removed the MStest/VStest wrapper for performance reasons, but now we can have reporting AND performance!) See https://dev.azure.com/ms/terminal/_build/results?buildId=101654&view=ms.vss-test-web.build-test-results-tab for an example. ////I explored running all of the tests on Helix but.... the Helix setup time is long and the resources are more expensive. I felt it was better to preserve the ""quick signal"" by continuing to run these directly on the build machine (and skipping the more expensive/slow Helix setup if they fail.) It also works well with the split between PR builds not running Helix and the rolling build running Helix. PR builds will get a good chunk of tests for a quick turn around and the rolling build will finish the more thorough job a bit more slowly.////## Validation Steps Performed//- [x] Ran the updated pipelines with Pull Request configuration ensuring that Helix tests don't run in the usual CI//- [x] Ran with simulation of the rolling build to ensure that the tests now running in Helix will pass. All failures marked for follow on in reference issues.",microsoft/terminal,#7286,open,2020-08-13T21:41:29Z,
121,5d082ffe67c9714472dcc1548c6b5b7b60780d2c,"Helix Testing (#6992)//Use the Helix testing orchestration framework to run our Terminal LocalTests and Console Host UIA tests.////## References//#### Creates the following new issues://- #7281 - re-enable local tests that were disabled to turn on Helix//- #7282 - re-enable UIA tests that were disabled to turn on Helix//- #7286 - investigate and implement appropriate compromise solution to how Skipped is handled by MUX Helix scripts////#### Consumes from://- #7164 - The update to TAEF includes wttlog.dll. The WTT logs are what MUX's Helix scripts use to track the run state, convert to XUnit format, and notify both Helix and AzDO of what's going on.////#### Produces for://- #671 - Making Terminal UIA tests is now possible//- #6963 - MUX's Helix scripts are already ready to capture PGO data on the Helix machines as certain tests run. Presuming we can author some reasonable scenarios, turning on the Helix environment gets us a good way toward automated PGO.////#### Related://- #4490 - We lost the AzDO integration of our test data when I moved from the TAEF/VSTest adapter directly back to TE. Thanks to the WTTLog + Helix conversion scripts to XUnit + new upload phase, we have it back!////## PR Checklist//* [x] Closes #3838//* [x] I work here.//* [x] Literally adds tests.//* [ ] Should I update a testing doc in this repo?//* [x] Am core contributor. Hear me roar.//* [ ] Correct spell-checking the right way before merge.////## Detailed Description of the Pull Request / Additional comments//We have had two classes of tests that don't work in our usual build-machine testing environment://1. Tests that require interactive UI automation or input injection (a.k.a. require a logged in user)//2. Tests that require the entire Windows Terminal to stand up (because our Xaml Islands dependency requires 1903 or later and the Windows Server instance for the build is based on 1809.)////The Helix testing environment solves both of these and is brought to us by our friends over in https://github.com/microsoft/microsoft-ui-xaml.////This PR takes a large portion of scripts and pipeline configuration steps from the Microsoft-UI-XAML repository and adjusts them for Terminal needs.//You can see the source of most of the files in either https://github.com/microsoft/microsoft-ui-xaml/tree/master/build/Helix or https://github.com/microsoft/microsoft-ui-xaml/tree/master/build/AzurePipelinesTemplates////Some of the modifications in the files include (but are not limited to) reasons like://- Our test binaries are named differently than MUX's test binaries//- We don't need certain types of testing that MUX does.//- We use C++ and C# tests while MUX was using only C# tests (so the naming pattern and some of the parsing of those names is different e.g. :: separators in C++ and . separators in C#)//- Our pipeline phases work a bit differently than MUX and/or we need significantly fewer pieces to the testing matrix (like we don't test a wide variety of OS versions).////The build now runs in a few stages://1. The usual build and run of unit tests/feature tests, packaging verification, and whatnot. This phase now also picks up and packs anything required for running tests in Helix into an artifact. (It also unifies the artifact name between the things Helix needs and the existing build outputs into the single `drop` artifact to make life a little easier.)//2. The Helix preparation build runs that picks up those artifacts, generates all the scripts required for Helix to understand the test modules/functions from our existing TAEF tests, packs it all up, and queues it on the Helix pool.//3. Helix generates a VM for our testing environment and runs all the TAEF tests that require it. The orchestrator at helix.dot.net watches over this and tracks the success/fail and progress of each module and function. The scripts from our MUX friends handle installing dependencies, making the system quiet for better reliability, detecting flaky tests and rerunning them, and coordinating all the log uploads (including for the subruns of tests that are re-run.)//4. A final build phase is run to look through the results with the Helix API and clean up the marking of tests that are flaky, link all the screenshots and console output logs into the AzDO tests panel, and other such niceities.////We are set to run Helix tests on the Feature test policy of only x64 for now. ////Additionally, because the set up of the Helix VMs takes so long, we are *NOT* running these in PR trigger right now as I believe we all very much value our 15ish minute PR turnaround (and the VM takes another 15 minutes to just get going for whatever reason.) For now, they will only run as a rolling build on master after PRs are merged. We should still know when there's an issue within about an hour of something merging and multiple PRs merging fast will be done on the rolling build as a batch run (not one per).////In addition to setting up the entire Helix testing pipeline for the tests that require it, I've preserved our classic way of running unit and feature tests (that don't require an elaborate environment) directly on the build machines. But with one bonus feature... They now use some of the scripts from MUX to transform their log data and report it to AzDO so it shows up beautifully in the build report. (We used to have this before I removed the MStest/VStest wrapper for performance reasons, but now we can have reporting AND performance!) See https://dev.azure.com/ms/terminal/_build/results?buildId=101654&view=ms.vss-test-web.build-test-results-tab for an example. ////I explored running all of the tests on Helix but.... the Helix setup time is long and the resources are more expensive. I felt it was better to preserve the ""quick signal"" by continuing to run these directly on the build machine (and skipping the more expensive/slow Helix setup if they fail.) It also works well with the split between PR builds not running Helix and the rolling build running Helix. PR builds will get a good chunk of tests for a quick turn around and the rolling build will finish the more thorough job a bit more slowly.////## Validation Steps Performed//- [x] Ran the updated pipelines with Pull Request configuration ensuring that Helix tests don't run in the usual CI//- [x] Ran with simulation of the rolling build to ensure that the tests now running in Helix will pass. All failures marked for follow on in reference issues.",microsoft/terminal,#7164,closed,2020-08-03T20:26:45Z,2020-08-03T20:47:03Z
122,5d082ffe67c9714472dcc1548c6b5b7b60780d2c,"Helix Testing (#6992)//Use the Helix testing orchestration framework to run our Terminal LocalTests and Console Host UIA tests.////## References//#### Creates the following new issues://- #7281 - re-enable local tests that were disabled to turn on Helix//- #7282 - re-enable UIA tests that were disabled to turn on Helix//- #7286 - investigate and implement appropriate compromise solution to how Skipped is handled by MUX Helix scripts////#### Consumes from://- #7164 - The update to TAEF includes wttlog.dll. The WTT logs are what MUX's Helix scripts use to track the run state, convert to XUnit format, and notify both Helix and AzDO of what's going on.////#### Produces for://- #671 - Making Terminal UIA tests is now possible//- #6963 - MUX's Helix scripts are already ready to capture PGO data on the Helix machines as certain tests run. Presuming we can author some reasonable scenarios, turning on the Helix environment gets us a good way toward automated PGO.////#### Related://- #4490 - We lost the AzDO integration of our test data when I moved from the TAEF/VSTest adapter directly back to TE. Thanks to the WTTLog + Helix conversion scripts to XUnit + new upload phase, we have it back!////## PR Checklist//* [x] Closes #3838//* [x] I work here.//* [x] Literally adds tests.//* [ ] Should I update a testing doc in this repo?//* [x] Am core contributor. Hear me roar.//* [ ] Correct spell-checking the right way before merge.////## Detailed Description of the Pull Request / Additional comments//We have had two classes of tests that don't work in our usual build-machine testing environment://1. Tests that require interactive UI automation or input injection (a.k.a. require a logged in user)//2. Tests that require the entire Windows Terminal to stand up (because our Xaml Islands dependency requires 1903 or later and the Windows Server instance for the build is based on 1809.)////The Helix testing environment solves both of these and is brought to us by our friends over in https://github.com/microsoft/microsoft-ui-xaml.////This PR takes a large portion of scripts and pipeline configuration steps from the Microsoft-UI-XAML repository and adjusts them for Terminal needs.//You can see the source of most of the files in either https://github.com/microsoft/microsoft-ui-xaml/tree/master/build/Helix or https://github.com/microsoft/microsoft-ui-xaml/tree/master/build/AzurePipelinesTemplates////Some of the modifications in the files include (but are not limited to) reasons like://- Our test binaries are named differently than MUX's test binaries//- We don't need certain types of testing that MUX does.//- We use C++ and C# tests while MUX was using only C# tests (so the naming pattern and some of the parsing of those names is different e.g. :: separators in C++ and . separators in C#)//- Our pipeline phases work a bit differently than MUX and/or we need significantly fewer pieces to the testing matrix (like we don't test a wide variety of OS versions).////The build now runs in a few stages://1. The usual build and run of unit tests/feature tests, packaging verification, and whatnot. This phase now also picks up and packs anything required for running tests in Helix into an artifact. (It also unifies the artifact name between the things Helix needs and the existing build outputs into the single `drop` artifact to make life a little easier.)//2. The Helix preparation build runs that picks up those artifacts, generates all the scripts required for Helix to understand the test modules/functions from our existing TAEF tests, packs it all up, and queues it on the Helix pool.//3. Helix generates a VM for our testing environment and runs all the TAEF tests that require it. The orchestrator at helix.dot.net watches over this and tracks the success/fail and progress of each module and function. The scripts from our MUX friends handle installing dependencies, making the system quiet for better reliability, detecting flaky tests and rerunning them, and coordinating all the log uploads (including for the subruns of tests that are re-run.)//4. A final build phase is run to look through the results with the Helix API and clean up the marking of tests that are flaky, link all the screenshots and console output logs into the AzDO tests panel, and other such niceities.////We are set to run Helix tests on the Feature test policy of only x64 for now. ////Additionally, because the set up of the Helix VMs takes so long, we are *NOT* running these in PR trigger right now as I believe we all very much value our 15ish minute PR turnaround (and the VM takes another 15 minutes to just get going for whatever reason.) For now, they will only run as a rolling build on master after PRs are merged. We should still know when there's an issue within about an hour of something merging and multiple PRs merging fast will be done on the rolling build as a batch run (not one per).////In addition to setting up the entire Helix testing pipeline for the tests that require it, I've preserved our classic way of running unit and feature tests (that don't require an elaborate environment) directly on the build machines. But with one bonus feature... They now use some of the scripts from MUX to transform their log data and report it to AzDO so it shows up beautifully in the build report. (We used to have this before I removed the MStest/VStest wrapper for performance reasons, but now we can have reporting AND performance!) See https://dev.azure.com/ms/terminal/_build/results?buildId=101654&view=ms.vss-test-web.build-test-results-tab for an example. ////I explored running all of the tests on Helix but.... the Helix setup time is long and the resources are more expensive. I felt it was better to preserve the ""quick signal"" by continuing to run these directly on the build machine (and skipping the more expensive/slow Helix setup if they fail.) It also works well with the split between PR builds not running Helix and the rolling build running Helix. PR builds will get a good chunk of tests for a quick turn around and the rolling build will finish the more thorough job a bit more slowly.////## Validation Steps Performed//- [x] Ran the updated pipelines with Pull Request configuration ensuring that Helix tests don't run in the usual CI//- [x] Ran with simulation of the rolling build to ensure that the tests now running in Helix will pass. All failures marked for follow on in reference issues.",microsoft/terminal,#671,closed,2019-05-10T17:07:56Z,2021-05-18T17:48:31Z
123,5d082ffe67c9714472dcc1548c6b5b7b60780d2c,"Helix Testing (#6992)//Use the Helix testing orchestration framework to run our Terminal LocalTests and Console Host UIA tests.////## References//#### Creates the following new issues://- #7281 - re-enable local tests that were disabled to turn on Helix//- #7282 - re-enable UIA tests that were disabled to turn on Helix//- #7286 - investigate and implement appropriate compromise solution to how Skipped is handled by MUX Helix scripts////#### Consumes from://- #7164 - The update to TAEF includes wttlog.dll. The WTT logs are what MUX's Helix scripts use to track the run state, convert to XUnit format, and notify both Helix and AzDO of what's going on.////#### Produces for://- #671 - Making Terminal UIA tests is now possible//- #6963 - MUX's Helix scripts are already ready to capture PGO data on the Helix machines as certain tests run. Presuming we can author some reasonable scenarios, turning on the Helix environment gets us a good way toward automated PGO.////#### Related://- #4490 - We lost the AzDO integration of our test data when I moved from the TAEF/VSTest adapter directly back to TE. Thanks to the WTTLog + Helix conversion scripts to XUnit + new upload phase, we have it back!////## PR Checklist//* [x] Closes #3838//* [x] I work here.//* [x] Literally adds tests.//* [ ] Should I update a testing doc in this repo?//* [x] Am core contributor. Hear me roar.//* [ ] Correct spell-checking the right way before merge.////## Detailed Description of the Pull Request / Additional comments//We have had two classes of tests that don't work in our usual build-machine testing environment://1. Tests that require interactive UI automation or input injection (a.k.a. require a logged in user)//2. Tests that require the entire Windows Terminal to stand up (because our Xaml Islands dependency requires 1903 or later and the Windows Server instance for the build is based on 1809.)////The Helix testing environment solves both of these and is brought to us by our friends over in https://github.com/microsoft/microsoft-ui-xaml.////This PR takes a large portion of scripts and pipeline configuration steps from the Microsoft-UI-XAML repository and adjusts them for Terminal needs.//You can see the source of most of the files in either https://github.com/microsoft/microsoft-ui-xaml/tree/master/build/Helix or https://github.com/microsoft/microsoft-ui-xaml/tree/master/build/AzurePipelinesTemplates////Some of the modifications in the files include (but are not limited to) reasons like://- Our test binaries are named differently than MUX's test binaries//- We don't need certain types of testing that MUX does.//- We use C++ and C# tests while MUX was using only C# tests (so the naming pattern and some of the parsing of those names is different e.g. :: separators in C++ and . separators in C#)//- Our pipeline phases work a bit differently than MUX and/or we need significantly fewer pieces to the testing matrix (like we don't test a wide variety of OS versions).////The build now runs in a few stages://1. The usual build and run of unit tests/feature tests, packaging verification, and whatnot. This phase now also picks up and packs anything required for running tests in Helix into an artifact. (It also unifies the artifact name between the things Helix needs and the existing build outputs into the single `drop` artifact to make life a little easier.)//2. The Helix preparation build runs that picks up those artifacts, generates all the scripts required for Helix to understand the test modules/functions from our existing TAEF tests, packs it all up, and queues it on the Helix pool.//3. Helix generates a VM for our testing environment and runs all the TAEF tests that require it. The orchestrator at helix.dot.net watches over this and tracks the success/fail and progress of each module and function. The scripts from our MUX friends handle installing dependencies, making the system quiet for better reliability, detecting flaky tests and rerunning them, and coordinating all the log uploads (including for the subruns of tests that are re-run.)//4. A final build phase is run to look through the results with the Helix API and clean up the marking of tests that are flaky, link all the screenshots and console output logs into the AzDO tests panel, and other such niceities.////We are set to run Helix tests on the Feature test policy of only x64 for now. ////Additionally, because the set up of the Helix VMs takes so long, we are *NOT* running these in PR trigger right now as I believe we all very much value our 15ish minute PR turnaround (and the VM takes another 15 minutes to just get going for whatever reason.) For now, they will only run as a rolling build on master after PRs are merged. We should still know when there's an issue within about an hour of something merging and multiple PRs merging fast will be done on the rolling build as a batch run (not one per).////In addition to setting up the entire Helix testing pipeline for the tests that require it, I've preserved our classic way of running unit and feature tests (that don't require an elaborate environment) directly on the build machines. But with one bonus feature... They now use some of the scripts from MUX to transform their log data and report it to AzDO so it shows up beautifully in the build report. (We used to have this before I removed the MStest/VStest wrapper for performance reasons, but now we can have reporting AND performance!) See https://dev.azure.com/ms/terminal/_build/results?buildId=101654&view=ms.vss-test-web.build-test-results-tab for an example. ////I explored running all of the tests on Helix but.... the Helix setup time is long and the resources are more expensive. I felt it was better to preserve the ""quick signal"" by continuing to run these directly on the build machine (and skipping the more expensive/slow Helix setup if they fail.) It also works well with the split between PR builds not running Helix and the rolling build running Helix. PR builds will get a good chunk of tests for a quick turn around and the rolling build will finish the more thorough job a bit more slowly.////## Validation Steps Performed//- [x] Ran the updated pipelines with Pull Request configuration ensuring that Helix tests don't run in the usual CI//- [x] Ran with simulation of the rolling build to ensure that the tests now running in Helix will pass. All failures marked for follow on in reference issues.",microsoft/terminal,#6963,closed,2020-07-17T16:07:32Z,2021-05-13T21:12:30Z
124,5d082ffe67c9714472dcc1548c6b5b7b60780d2c,"Helix Testing (#6992)//Use the Helix testing orchestration framework to run our Terminal LocalTests and Console Host UIA tests.////## References//#### Creates the following new issues://- #7281 - re-enable local tests that were disabled to turn on Helix//- #7282 - re-enable UIA tests that were disabled to turn on Helix//- #7286 - investigate and implement appropriate compromise solution to how Skipped is handled by MUX Helix scripts////#### Consumes from://- #7164 - The update to TAEF includes wttlog.dll. The WTT logs are what MUX's Helix scripts use to track the run state, convert to XUnit format, and notify both Helix and AzDO of what's going on.////#### Produces for://- #671 - Making Terminal UIA tests is now possible//- #6963 - MUX's Helix scripts are already ready to capture PGO data on the Helix machines as certain tests run. Presuming we can author some reasonable scenarios, turning on the Helix environment gets us a good way toward automated PGO.////#### Related://- #4490 - We lost the AzDO integration of our test data when I moved from the TAEF/VSTest adapter directly back to TE. Thanks to the WTTLog + Helix conversion scripts to XUnit + new upload phase, we have it back!////## PR Checklist//* [x] Closes #3838//* [x] I work here.//* [x] Literally adds tests.//* [ ] Should I update a testing doc in this repo?//* [x] Am core contributor. Hear me roar.//* [ ] Correct spell-checking the right way before merge.////## Detailed Description of the Pull Request / Additional comments//We have had two classes of tests that don't work in our usual build-machine testing environment://1. Tests that require interactive UI automation or input injection (a.k.a. require a logged in user)//2. Tests that require the entire Windows Terminal to stand up (because our Xaml Islands dependency requires 1903 or later and the Windows Server instance for the build is based on 1809.)////The Helix testing environment solves both of these and is brought to us by our friends over in https://github.com/microsoft/microsoft-ui-xaml.////This PR takes a large portion of scripts and pipeline configuration steps from the Microsoft-UI-XAML repository and adjusts them for Terminal needs.//You can see the source of most of the files in either https://github.com/microsoft/microsoft-ui-xaml/tree/master/build/Helix or https://github.com/microsoft/microsoft-ui-xaml/tree/master/build/AzurePipelinesTemplates////Some of the modifications in the files include (but are not limited to) reasons like://- Our test binaries are named differently than MUX's test binaries//- We don't need certain types of testing that MUX does.//- We use C++ and C# tests while MUX was using only C# tests (so the naming pattern and some of the parsing of those names is different e.g. :: separators in C++ and . separators in C#)//- Our pipeline phases work a bit differently than MUX and/or we need significantly fewer pieces to the testing matrix (like we don't test a wide variety of OS versions).////The build now runs in a few stages://1. The usual build and run of unit tests/feature tests, packaging verification, and whatnot. This phase now also picks up and packs anything required for running tests in Helix into an artifact. (It also unifies the artifact name between the things Helix needs and the existing build outputs into the single `drop` artifact to make life a little easier.)//2. The Helix preparation build runs that picks up those artifacts, generates all the scripts required for Helix to understand the test modules/functions from our existing TAEF tests, packs it all up, and queues it on the Helix pool.//3. Helix generates a VM for our testing environment and runs all the TAEF tests that require it. The orchestrator at helix.dot.net watches over this and tracks the success/fail and progress of each module and function. The scripts from our MUX friends handle installing dependencies, making the system quiet for better reliability, detecting flaky tests and rerunning them, and coordinating all the log uploads (including for the subruns of tests that are re-run.)//4. A final build phase is run to look through the results with the Helix API and clean up the marking of tests that are flaky, link all the screenshots and console output logs into the AzDO tests panel, and other such niceities.////We are set to run Helix tests on the Feature test policy of only x64 for now. ////Additionally, because the set up of the Helix VMs takes so long, we are *NOT* running these in PR trigger right now as I believe we all very much value our 15ish minute PR turnaround (and the VM takes another 15 minutes to just get going for whatever reason.) For now, they will only run as a rolling build on master after PRs are merged. We should still know when there's an issue within about an hour of something merging and multiple PRs merging fast will be done on the rolling build as a batch run (not one per).////In addition to setting up the entire Helix testing pipeline for the tests that require it, I've preserved our classic way of running unit and feature tests (that don't require an elaborate environment) directly on the build machines. But with one bonus feature... They now use some of the scripts from MUX to transform their log data and report it to AzDO so it shows up beautifully in the build report. (We used to have this before I removed the MStest/VStest wrapper for performance reasons, but now we can have reporting AND performance!) See https://dev.azure.com/ms/terminal/_build/results?buildId=101654&view=ms.vss-test-web.build-test-results-tab for an example. ////I explored running all of the tests on Helix but.... the Helix setup time is long and the resources are more expensive. I felt it was better to preserve the ""quick signal"" by continuing to run these directly on the build machine (and skipping the more expensive/slow Helix setup if they fail.) It also works well with the split between PR builds not running Helix and the rolling build running Helix. PR builds will get a good chunk of tests for a quick turn around and the rolling build will finish the more thorough job a bit more slowly.////## Validation Steps Performed//- [x] Ran the updated pipelines with Pull Request configuration ensuring that Helix tests don't run in the usual CI//- [x] Ran with simulation of the rolling build to ensure that the tests now running in Helix will pass. All failures marked for follow on in reference issues.",microsoft/terminal,#4490,closed,2020-02-06T19:40:00Z,2020-02-10T19:14:07Z
125,5d082ffe67c9714472dcc1548c6b5b7b60780d2c,"Helix Testing (#6992)//Use the Helix testing orchestration framework to run our Terminal LocalTests and Console Host UIA tests.////## References//#### Creates the following new issues://- #7281 - re-enable local tests that were disabled to turn on Helix//- #7282 - re-enable UIA tests that were disabled to turn on Helix//- #7286 - investigate and implement appropriate compromise solution to how Skipped is handled by MUX Helix scripts////#### Consumes from://- #7164 - The update to TAEF includes wttlog.dll. The WTT logs are what MUX's Helix scripts use to track the run state, convert to XUnit format, and notify both Helix and AzDO of what's going on.////#### Produces for://- #671 - Making Terminal UIA tests is now possible//- #6963 - MUX's Helix scripts are already ready to capture PGO data on the Helix machines as certain tests run. Presuming we can author some reasonable scenarios, turning on the Helix environment gets us a good way toward automated PGO.////#### Related://- #4490 - We lost the AzDO integration of our test data when I moved from the TAEF/VSTest adapter directly back to TE. Thanks to the WTTLog + Helix conversion scripts to XUnit + new upload phase, we have it back!////## PR Checklist//* [x] Closes #3838//* [x] I work here.//* [x] Literally adds tests.//* [ ] Should I update a testing doc in this repo?//* [x] Am core contributor. Hear me roar.//* [ ] Correct spell-checking the right way before merge.////## Detailed Description of the Pull Request / Additional comments//We have had two classes of tests that don't work in our usual build-machine testing environment://1. Tests that require interactive UI automation or input injection (a.k.a. require a logged in user)//2. Tests that require the entire Windows Terminal to stand up (because our Xaml Islands dependency requires 1903 or later and the Windows Server instance for the build is based on 1809.)////The Helix testing environment solves both of these and is brought to us by our friends over in https://github.com/microsoft/microsoft-ui-xaml.////This PR takes a large portion of scripts and pipeline configuration steps from the Microsoft-UI-XAML repository and adjusts them for Terminal needs.//You can see the source of most of the files in either https://github.com/microsoft/microsoft-ui-xaml/tree/master/build/Helix or https://github.com/microsoft/microsoft-ui-xaml/tree/master/build/AzurePipelinesTemplates////Some of the modifications in the files include (but are not limited to) reasons like://- Our test binaries are named differently than MUX's test binaries//- We don't need certain types of testing that MUX does.//- We use C++ and C# tests while MUX was using only C# tests (so the naming pattern and some of the parsing of those names is different e.g. :: separators in C++ and . separators in C#)//- Our pipeline phases work a bit differently than MUX and/or we need significantly fewer pieces to the testing matrix (like we don't test a wide variety of OS versions).////The build now runs in a few stages://1. The usual build and run of unit tests/feature tests, packaging verification, and whatnot. This phase now also picks up and packs anything required for running tests in Helix into an artifact. (It also unifies the artifact name between the things Helix needs and the existing build outputs into the single `drop` artifact to make life a little easier.)//2. The Helix preparation build runs that picks up those artifacts, generates all the scripts required for Helix to understand the test modules/functions from our existing TAEF tests, packs it all up, and queues it on the Helix pool.//3. Helix generates a VM for our testing environment and runs all the TAEF tests that require it. The orchestrator at helix.dot.net watches over this and tracks the success/fail and progress of each module and function. The scripts from our MUX friends handle installing dependencies, making the system quiet for better reliability, detecting flaky tests and rerunning them, and coordinating all the log uploads (including for the subruns of tests that are re-run.)//4. A final build phase is run to look through the results with the Helix API and clean up the marking of tests that are flaky, link all the screenshots and console output logs into the AzDO tests panel, and other such niceities.////We are set to run Helix tests on the Feature test policy of only x64 for now. ////Additionally, because the set up of the Helix VMs takes so long, we are *NOT* running these in PR trigger right now as I believe we all very much value our 15ish minute PR turnaround (and the VM takes another 15 minutes to just get going for whatever reason.) For now, they will only run as a rolling build on master after PRs are merged. We should still know when there's an issue within about an hour of something merging and multiple PRs merging fast will be done on the rolling build as a batch run (not one per).////In addition to setting up the entire Helix testing pipeline for the tests that require it, I've preserved our classic way of running unit and feature tests (that don't require an elaborate environment) directly on the build machines. But with one bonus feature... They now use some of the scripts from MUX to transform their log data and report it to AzDO so it shows up beautifully in the build report. (We used to have this before I removed the MStest/VStest wrapper for performance reasons, but now we can have reporting AND performance!) See https://dev.azure.com/ms/terminal/_build/results?buildId=101654&view=ms.vss-test-web.build-test-results-tab for an example. ////I explored running all of the tests on Helix but.... the Helix setup time is long and the resources are more expensive. I felt it was better to preserve the ""quick signal"" by continuing to run these directly on the build machine (and skipping the more expensive/slow Helix setup if they fail.) It also works well with the split between PR builds not running Helix and the rolling build running Helix. PR builds will get a good chunk of tests for a quick turn around and the rolling build will finish the more thorough job a bit more slowly.////## Validation Steps Performed//- [x] Ran the updated pipelines with Pull Request configuration ensuring that Helix tests don't run in the usual CI//- [x] Ran with simulation of the rolling build to ensure that the tests now running in Helix will pass. All failures marked for follow on in reference issues.",microsoft/terminal,#3838,closed,2019-12-04T21:49:00Z,2020-08-18T18:23:25Z
126,a19f787657c2f0e85bc93f5b078cc3481774ba01,"M2 Integration (#132)//* botbuilder-core refactor with unit tests////* implementation of botbuilder-core-extensions////* updated unit tests////* Added conversation state unit tests////* Added support for middleware as an object////* Changed conversation state middleware to be a class////* Added UserState middleware and tests////* Added test for better code coverage.////* Added browser storage tests////* Added more unit tests////* Broke out separate BotState class////* Renamed TurnContext back to BotContext////* Added new BotStateSet class////* Added additional test to middlewareSet////* 100% code coverage on BotState, ConversationState, and UserState classes.////* 100% code coverage for BotStateSet////* updated test adapter to better support updateActivity() and deleteActivity()////* changed BotContext.sendActivities() to take a variable number of params.////* 100% code coverage for TestAdapter////* 100% code coverage on CardFactory////* 100% code coverage for MessageFactory////* Updated BotAdapter.deleteActivity to take a conversation reference instead of an id.////* 100% code coverage for BotFrameworkAdapter////* Implemented new style ConsoleAdapter////* updated botbuilder-core unit tests////* updated botbuilder-ai to use latest middleware pattern////* Updated UserState and ConversationState to add a property accessor to context object////* Updated BotContext to not be a generic////* new qna maker and file storage impl////* combined docs for botbuilder botbuilder-core botbuilder-core-extensions////* updated docs////* updated docs////* updated docs////* updated docs////* update docs////* update docs////* updated docs////* updated docs////* update docs////* update docs////* update docs////* updated docs////* updated docs////* updated docs////* update docs////* added BatchOutput class////* added BatchOutput middleware////* Updated botbuilder-azure to m2////* Updated botbuilder-choices to m2////* updated botbuilder-dialogs to m2////* updated docs////* updated echobot example////* updated echobot-es6 sample////* updated alarmbot sample////* fixed issue with recognizers-text dependency////* fixed broken recognizer-text refs////* fixed bug in waterfall////* updated alarm bot samples////* Added passing of locale through to recognizers////* botbuilder-prompts////* updated prompts for botbuilder-dialogs////* updated dialogs echobot sample////* updated dialogs alarmbot////* updated dialog samples to use async/await////* updated dialogs prompts sample////* removed un used import////* updated inside-middleware sample for dialogs////* updated echobot-ts sample to use async/await////* Updated alarmbot-es6 sample////* updated alarmbot-ts to use async/await////* cleaned up merge junk////* Added echobot-console-ts sample////* Updated console sample////* Added context to onSendActivity(), onUpdateActivity(), and onDeleteActivity()////* updated version num////* Fixed issue with connectors credential provider////* Added ability to pass a BotContext instnace into the constructor of anotehr BotContext////* Updated code coverage tests////* Tweak to simplify token refresh code////* removed inbound endOfConversation check as it wasn't working////* feat(DevTools): Improvements to Lerna and Developer Workflow. (#113)////Added npm postinstall scripts to automate lerna bootstrapping and make lerna transparent to the developer.//Added various npm run scripts to enable a single command to link botbuilder to the global node_modules folder to make it easier for developers to add their local cloned repo to a project.////* package files////* Added logic to return last call to end() as a DialogResult////* Added dialog based Control creation and sample////* Added support using symbols as keys off context cache////* sample update////* Updated DialogContext.endAll() to be fluent.////* updated BotState classes to use Symbols for cache keys////* Updated BatchOutput ot use Symbol based cache keys////* ListControl sample////* Updated sample////* Fixed build break////* fixed broken dialogs test////* Cleaned up control concept////- Created separate CompositControl and Control concepts.//- Both types of controls now automatically suport being used outside of Dialogs.//- Control usage is more consistant regardless of mode.//- Made state passed into DialogSet.createContext() more opaque.////* Stevenic/invoke (#122)////* Added support for 'invoke'////* added logic to cleanup saved invokeReponse entiries from map",microsoft/botbuilder-js,#132,closed,2018-03-20T22:50:23Z,2018-03-20T22:50:38Z
127,a19f787657c2f0e85bc93f5b078cc3481774ba01,"M2 Integration (#132)//* botbuilder-core refactor with unit tests////* implementation of botbuilder-core-extensions////* updated unit tests////* Added conversation state unit tests////* Added support for middleware as an object////* Changed conversation state middleware to be a class////* Added UserState middleware and tests////* Added test for better code coverage.////* Added browser storage tests////* Added more unit tests////* Broke out separate BotState class////* Renamed TurnContext back to BotContext////* Added new BotStateSet class////* Added additional test to middlewareSet////* 100% code coverage on BotState, ConversationState, and UserState classes.////* 100% code coverage for BotStateSet////* updated test adapter to better support updateActivity() and deleteActivity()////* changed BotContext.sendActivities() to take a variable number of params.////* 100% code coverage for TestAdapter////* 100% code coverage on CardFactory////* 100% code coverage for MessageFactory////* Updated BotAdapter.deleteActivity to take a conversation reference instead of an id.////* 100% code coverage for BotFrameworkAdapter////* Implemented new style ConsoleAdapter////* updated botbuilder-core unit tests////* updated botbuilder-ai to use latest middleware pattern////* Updated UserState and ConversationState to add a property accessor to context object////* Updated BotContext to not be a generic////* new qna maker and file storage impl////* combined docs for botbuilder botbuilder-core botbuilder-core-extensions////* updated docs////* updated docs////* updated docs////* updated docs////* update docs////* update docs////* updated docs////* updated docs////* update docs////* update docs////* update docs////* updated docs////* updated docs////* updated docs////* update docs////* added BatchOutput class////* added BatchOutput middleware////* Updated botbuilder-azure to m2////* Updated botbuilder-choices to m2////* updated botbuilder-dialogs to m2////* updated docs////* updated echobot example////* updated echobot-es6 sample////* updated alarmbot sample////* fixed issue with recognizers-text dependency////* fixed broken recognizer-text refs////* fixed bug in waterfall////* updated alarm bot samples////* Added passing of locale through to recognizers////* botbuilder-prompts////* updated prompts for botbuilder-dialogs////* updated dialogs echobot sample////* updated dialogs alarmbot////* updated dialog samples to use async/await////* updated dialogs prompts sample////* removed un used import////* updated inside-middleware sample for dialogs////* updated echobot-ts sample to use async/await////* Updated alarmbot-es6 sample////* updated alarmbot-ts to use async/await////* cleaned up merge junk////* Added echobot-console-ts sample////* Updated console sample////* Added context to onSendActivity(), onUpdateActivity(), and onDeleteActivity()////* updated version num////* Fixed issue with connectors credential provider////* Added ability to pass a BotContext instnace into the constructor of anotehr BotContext////* Updated code coverage tests////* Tweak to simplify token refresh code////* removed inbound endOfConversation check as it wasn't working////* feat(DevTools): Improvements to Lerna and Developer Workflow. (#113)////Added npm postinstall scripts to automate lerna bootstrapping and make lerna transparent to the developer.//Added various npm run scripts to enable a single command to link botbuilder to the global node_modules folder to make it easier for developers to add their local cloned repo to a project.////* package files////* Added logic to return last call to end() as a DialogResult////* Added dialog based Control creation and sample////* Added support using symbols as keys off context cache////* sample update////* Updated DialogContext.endAll() to be fluent.////* updated BotState classes to use Symbols for cache keys////* Updated BatchOutput ot use Symbol based cache keys////* ListControl sample////* Updated sample////* Fixed build break////* fixed broken dialogs test////* Cleaned up control concept////- Created separate CompositControl and Control concepts.//- Both types of controls now automatically suport being used outside of Dialogs.//- Control usage is more consistant regardless of mode.//- Made state passed into DialogSet.createContext() more opaque.////* Stevenic/invoke (#122)////* Added support for 'invoke'////* added logic to cleanup saved invokeReponse entiries from map",microsoft/botbuilder-js,#113,closed,2018-03-13T20:25:31Z,2018-03-16T23:11:25Z
128,a19f787657c2f0e85bc93f5b078cc3481774ba01,"M2 Integration (#132)//* botbuilder-core refactor with unit tests////* implementation of botbuilder-core-extensions////* updated unit tests////* Added conversation state unit tests////* Added support for middleware as an object////* Changed conversation state middleware to be a class////* Added UserState middleware and tests////* Added test for better code coverage.////* Added browser storage tests////* Added more unit tests////* Broke out separate BotState class////* Renamed TurnContext back to BotContext////* Added new BotStateSet class////* Added additional test to middlewareSet////* 100% code coverage on BotState, ConversationState, and UserState classes.////* 100% code coverage for BotStateSet////* updated test adapter to better support updateActivity() and deleteActivity()////* changed BotContext.sendActivities() to take a variable number of params.////* 100% code coverage for TestAdapter////* 100% code coverage on CardFactory////* 100% code coverage for MessageFactory////* Updated BotAdapter.deleteActivity to take a conversation reference instead of an id.////* 100% code coverage for BotFrameworkAdapter////* Implemented new style ConsoleAdapter////* updated botbuilder-core unit tests////* updated botbuilder-ai to use latest middleware pattern////* Updated UserState and ConversationState to add a property accessor to context object////* Updated BotContext to not be a generic////* new qna maker and file storage impl////* combined docs for botbuilder botbuilder-core botbuilder-core-extensions////* updated docs////* updated docs////* updated docs////* updated docs////* update docs////* update docs////* updated docs////* updated docs////* update docs////* update docs////* update docs////* updated docs////* updated docs////* updated docs////* update docs////* added BatchOutput class////* added BatchOutput middleware////* Updated botbuilder-azure to m2////* Updated botbuilder-choices to m2////* updated botbuilder-dialogs to m2////* updated docs////* updated echobot example////* updated echobot-es6 sample////* updated alarmbot sample////* fixed issue with recognizers-text dependency////* fixed broken recognizer-text refs////* fixed bug in waterfall////* updated alarm bot samples////* Added passing of locale through to recognizers////* botbuilder-prompts////* updated prompts for botbuilder-dialogs////* updated dialogs echobot sample////* updated dialogs alarmbot////* updated dialog samples to use async/await////* updated dialogs prompts sample////* removed un used import////* updated inside-middleware sample for dialogs////* updated echobot-ts sample to use async/await////* Updated alarmbot-es6 sample////* updated alarmbot-ts to use async/await////* cleaned up merge junk////* Added echobot-console-ts sample////* Updated console sample////* Added context to onSendActivity(), onUpdateActivity(), and onDeleteActivity()////* updated version num////* Fixed issue with connectors credential provider////* Added ability to pass a BotContext instnace into the constructor of anotehr BotContext////* Updated code coverage tests////* Tweak to simplify token refresh code////* removed inbound endOfConversation check as it wasn't working////* feat(DevTools): Improvements to Lerna and Developer Workflow. (#113)////Added npm postinstall scripts to automate lerna bootstrapping and make lerna transparent to the developer.//Added various npm run scripts to enable a single command to link botbuilder to the global node_modules folder to make it easier for developers to add their local cloned repo to a project.////* package files////* Added logic to return last call to end() as a DialogResult////* Added dialog based Control creation and sample////* Added support using symbols as keys off context cache////* sample update////* Updated DialogContext.endAll() to be fluent.////* updated BotState classes to use Symbols for cache keys////* Updated BatchOutput ot use Symbol based cache keys////* ListControl sample////* Updated sample////* Fixed build break////* fixed broken dialogs test////* Cleaned up control concept////- Created separate CompositControl and Control concepts.//- Both types of controls now automatically suport being used outside of Dialogs.//- Control usage is more consistant regardless of mode.//- Made state passed into DialogSet.createContext() more opaque.////* Stevenic/invoke (#122)////* Added support for 'invoke'////* added logic to cleanup saved invokeReponse entiries from map",microsoft/botbuilder-js,#122,closed,2018-03-16T06:46:18Z,2018-03-20T22:42:06Z
129,f516a03c01b82fcc45fec792b5dfd792f9e06a83,Merge pull request #317 from jterry75/simplify_request_return//Simplify the bridge request/return pattern,microsoft/opengcs,#317,closed,2019-06-06T04:46:14Z,2019-06-06T22:51:06Z
